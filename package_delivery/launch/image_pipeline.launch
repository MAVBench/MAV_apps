<launch>
  <!-- args and params --> 
  <!-- Behzad's workstation ip --> 
  <!-- arg name="host_ip" default="10.157.90.51" /-->
  <!--arg name="host_ip" default="169.254.153.158" /-->
  <!-- Hasans's workstation ip --> 
  <!-- arg name="host_ip" default="10.157.90.49" /-->
  <!-- Hasans's direct connection ip --> 
  <arg name="host_ip" default="10.16.0.172" />
  <!--Wenzhi's workstation ip-->
  <!--arg name="host_ip" default="10.157.90.62" /-->
  <!-- Sri's workstation ip --> 
  <!--arg name="host_ip" default="10.157.90.132" /-->
  <param name="ip_addr" value="$(arg host_ip)" />

  <!-- Drone's physical characteristics /-->
  <arg name="a_max" default="5"/> 
  <arg name="v_max" default="3.0"/> 
  <param name="future_col_drone_radius" value="1.5"/>
  <param name="future_col_drone_height" value="0.6"/>
  <arg name="planner_drone_radius" default="2"/>
  <arg name="planner_drone_height" default="0.6"/>
  
  <arg name="planning_resolution" default=".85"/>
  <arg name="sensor_max_range" default="30" />
  <arg name="fly_trajectory_time_out" default=".01"/> 
  <arg name="planning_budget" default="9"/>
  <param name="planning_budget" value="$(arg planning_budget)"/>


  <arg name="max_yaw_rate" default="90"/>
  <arg name="max_yaw_rate_during_flight" default="90"/>
  <param name="v_max" value="$(arg v_max)"/>
  <param name="a_max" value="$(arg a_max)"/>
  <param name="max_yaw_rate" value="$(arg max_yaw_rate)"/>
  <param name="max_yaw_rate_during_flight" value="$(arg max_yaw_rate_during_flight)"/>
  <param name="fly_trajectory_time_out" value="$(arg fly_trajectory_time_out)"/> 

  
  <!-- sensors /-->
  <arg name="all_front" default="true"/>	

  <!-- Set the localization method /-->
  <!--arg name="localization_method" default="vins_mono" /-->
  <!--arg name="localization_method" default="gps" /-->
  <arg name="localization_method" default="ground_truth" />

  <param name="localization_method" value="$(arg localization_method)" />

  <!-- stat file-->
  <param name="stats_file_addr" value="$(find package_delivery)/../data/package_delivery/stats.json" />
  <param name="supervisor_mailbox" value="$(find package_delivery)/../data/package_delivery/supervisor_mailbox.txt" />

  <!-- setting DEBUG to false prevents publishing and subscribing to rviz /--> 
  <!-- also planning to prevent stdio stuff(if they really matter)-->
  <arg name="DEBUG" default="true" />
  <arg name="CLCT_DATA" value="true" />
  <param name="ros_DEBUG" type="bool" value="$(arg DEBUG)" />
  <param name="DEBUG"  value="$(arg DEBUG)" />
  <param name="CLCT_DATA" value="$(arg CLCT_DATA)"/>

  
  <group if="$(arg CLCT_DATA)">
  <param name="enable_statistics" value="true"/>
  </group> 

  <!-- only for to octomap and pt cloud--> 
  <arg name="data_collection_iteration_freq" value="150" />
  <param name="data_collection_iteration_freq_ptCld" value="$(eval 5*arg('data_collection_iteration_freq'))"/>


  <!-- launch prefixes -->

	<!-- Point-cloud publisher -->
 	<node pkg="airsim_img_publisher" type="airsim_imgPublisher" name="airsim_imgPublisher" output="screen">
		<!-- IP of the Airsim computer -->
		<param name="Airsim_ip" value="$(arg host_ip)" />

		<!-- Port of the Airsim computer (this is default, do not change!) -->
		<param name="Airsim_port" value="41451"/>

		<param name="loop_rate" value="25"/>

		<!-- RGB camera parameters (parameters when calibrated) -->
	    <param name="all_front" value="$(arg all_front)"/>	
        <param name="Fx" value="256"/>
		<param name="Fy" value="256"/>
		<param name="cx" value="256"/>
		<param name="cy" value="144"/>
		<param name="scale_x" value="512"/>  <!-- Width when calibrated!-->
		<param name="scale_y" value="288"/> <!-- Height when calibrated!-->

		<!-- Depth baseline -->
		<param name="Tx" value="0.14"/> 
		<param name="scale" value="0.38"/> 

        <!-- Localization of the depth images -->
        <param name="localization_method" value="$(arg localization_method)" />
	</node>



	<!-- Nodelet manager for this pipeline -->
    <node pkg="nodelet" type="nodelet" args="manager" name="depth_transforms_manager" output="screen">
        <!-- remap from="/points" to="/cloud_in" / -->
    </node>

	<!-- Convert to point cloud -->
	<node pkg="nodelet" type="nodelet" name="cloudify"
	args="load depth_image_proc/point_cloud_xyz depth_transforms_manager --no-bond" output="screen">

		<!-- Input: Camera calibration and metadata.  (sensor_msgs/CameraInfo) -->
		<remap from="rgb/camera_info" to="/Airsim/camera_info"/> 
		<!-- Input: Rectified depth image -->
		<remap from="image_rect" to="/Airsim/depth_front"/>

    </node>
    	</launch>

